---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
require(svglite)
set.seed(42)
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    dev = 'svglite',
    fig.path = "man/figures/README-",
    fig.showtext = TRUE,
    fig.width = 6.377953,
    fig.height = 3.93701,
    out.width = "100%"
)
```

# rendr

<!-- badges: start -->
<!-- badges: end -->

An R package for simulating reaction and reaction-diffusion systems.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

```r
devtools::install_github("dbarrows/rendr")
```

## Reaction system solvers

Networks are created using the [`bondr`](https://github.com/dbarrows/bondr) package. See [Creating Networks](https://github.com/dbarrows/bondr#creating-networks) for more details.

```{r}
library(rendr)

(mm_network <- parse_network(bondr::mm_string))
```

### RRE

A deterministic solver that uses the Reaction Rate Equation (RRE) in conjunction with an ode solver.

```{r}
(sys <- rsys(network = mm_network,
             state = c(301, 120, 0, 0),
             T = 30))
```
```{r}
(sol <- rre(sys))
```

A function is provided for easy visualisation of solutions.

```{r}
ggplot2::theme_set(mplot::theme_m())

rsol_plot(sol)
```

### SSA

Generate a single realisation of the Chemical Master Equation (CME) solution via the Stochastic Solution Algorithm (SSA).

```{r}
ssa(sys) %>%
    rsol_plot()
```

## Reaction-diffusion system solvers

Reaction-diffusion systems created via the `rdsys` class, which are constructed similarly to `rsys`s.

```{r}
(sys <- rdsys(
    network = parse_network("
             0 <-> U,  4e3, 2
             0  -> V,  1.2e4
        2U + V  -> 3U, 12.5e-8
    "),
    volume = volume(
        dims = c(40, 1, 1),
        h = 1/40,
        seed = c(25, 75)
    ),
    D = c(1e-3, 1e-1),
    T = 3.5
))
```

### ISSA

Generate a single realisation of the Reaction-diffusion Master Equation (RDME) solution via the Inhomogeneous Stochastic Solution Algorithm (ISSA).

```{r}
issa(sys) %>%
    rdsol_plot()
```

### NSM

Generate a single realisation of the Reaction-diffusion Master Equation (RDME) solution via the Next Subvolume Method (NSM). Usage of the `nsm` function is the same as with the [ISSA solver](#issa). The NSM algorithm is usually faster for systems with a large number of subvolume (voxels) relative to the reaction network size. You may have to try both the ISSA and NSM solver to see which is faster for a given reaction-diffusion system.

```{r time-small, cache = TRUE}
system.time(issa(sys, verbose = FALSE))
system.time(nsm(sys, verbose = FALSE))
```

```{r time-big, cache = TRUE}
sys_big <- sys
sys_big$volume <- volume(
        dims = c(100, 1, 1),
        h = 1/40,
        seed = c(25, 75)
    )
system.time(issa(sys_big, verbose = FALSE))
system.time(nsm(sys_big, verbose = FALSE))
```

